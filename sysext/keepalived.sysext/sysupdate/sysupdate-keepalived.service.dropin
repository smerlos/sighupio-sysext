# Drop-in for systemd-sysupdate.service to handle keepalived extension updates
# Place this file at: /etc/systemd/system/systemd-sysupdate.service.d/keepalived.conf

[Service]
ExecStartPre=/usr/bin/sh -c "readlink --canonicalize /etc/extensions/keepalived.raw > /tmp/keepalived"
ExecStartPre=/usr/lib/systemd/systemd-sysupdate -C keepalived update
ExecStartPost=/usr/bin/sh -c "readlink --canonicalize /etc/extensions/keepalived.raw > /tmp/keepalived-new"
ExecStartPost=/usr/bin/sh -c "if ! cmp --silent /tmp/keepalived /tmp/keepalived-new; then touch /run/reboot-required; fi"
